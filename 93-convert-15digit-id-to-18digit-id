public String convert15to18DigitId(String fifteenDigit)
{
    // Validate input
    if (fifteenDigit == null || fifteenDigit.length() != 15) {
        return '-1';
    }

    String suffix = '';
    // An index from which to pick the correct character
    String charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ012345';

    // Split the input ID into three 5-character segments
    for (Integer i = 0; i <= 3; i++) {
        String segment = fifteenDigit.substring(i * 5, (i + 1) * 5);
        String binaryString = '';

        // Calculate the binary string based on the case of the characters
        for (Integer j = 0; j < segment.length(); j++) {
            // Access individual characters withing the segment strings
            String c = segment.substring(j, j + 1);
            binaryString += (c.toUpperCase() == c ? '1' : '0'); 
        }

        // Convert the binary string to a decimal
        Integer decimalValue = Integer.valueOf(binaryString);

        // Use the decimal value as an index to select a character from the character set
        suffix += charSet.substring(decimalValue, decimalValue + 1);        
    }

    // Return the 18-digit ID
    return fifteenDigit + suffix;
}
